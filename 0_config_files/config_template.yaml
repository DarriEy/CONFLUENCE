### ==================================== CONFLUENCE template configuration file ============================================================
#
# This configuration file contains all settings required to run the CONFLUENCE workflow, from conceptualisation to evaluation.
# The configuration settings are organized based on modules and can be populated as the user moves through the individual components
# of the hydrological modelling exercise. This configuration file is comprised of the following sections:
# 
# 1. Global settings: Underlying configuration of each CONFLUENCE initation which are used throughout the workflow, e.g. root path etc. 
# 2. Geospatial settings: Configurations required to define the geospatial domain of the project and prepare geospatial input files
# 3. Model Agnostic settings: Configurations required for data pre-processing that is common to all models
# 4. Model Specific settings: Configurations required for data preprocessing that is specific depending on model selection
# 5. Evaluation settings: Configurations required to evaluate the model output
# 6. Optimisation settings: Configurations required for calibrating the hydrological model setup, including sensitivity and decision analysis
# 7. Data and path settings: Configurations for data characteristics and path specifications. Note: if deviating from default paths, an absolute path must be defined
#
### ============================================= 1. Global settings: =======================================================================

CONFLUENCE_DATA_DIR: /path/to/CONFLUENCE_data/                 # Directory with the confluence data directories, including the external installations
CONFLUENCE_CODE_DIR: /path/to/CONFLUENCE                       # Directory with the confluence code repository

# Experiment settings
DOMAIN_NAME: Bow_at_Banff                                      # Name of modeled domain
EXPERIMENT_ID: run_1                                           # Name of experiment
EXPERIMENT_TIME_START: 1980-01-02 01:00                        # Start time of experiment e.g. '2010-01-01 00:00'
EXPERIMENT_TIME_END: 2023-12-30 23:00                          # End time of experiment e.g. '2010-12-31 23:00'
CALIBRATION_PERIOD: 1982-01-01, 1990-12-30                     # start_date, end_date in format YYYY-MM-DD
EVALUATION_PERIOD:  2012-01-01, 2023-12-30                     # start_date, end_date in format YYYY-MM-DD
SPINUP_PERIOD: 1980-01-02, 1981-12-31                          # start_date, end_date in format YYYY-MM-DD

# Computatational settings
MPI_PROCESSES: 1                                               # Number of parallel processes allowed, based on your system's capabilities
FORCE_RUN_ALL_STEPS: False                                     # Run all steps in the workflow and overwrite existing files

# Logging settings
LOG_LEVEL: INFO                                                # Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_TO_FILE: True                                              # Save logs to file
LOG_FORMAT: detailed                                           # Log format: simple, detailed

### ============================================= 2. Geospatial settings: =================================================================

POUR_POINT_COORDS: 51.1722/-115.5717                           # Pour point coordinates lat/lon, if default use user provided shapefile. 
BOUNDING_BOX_COORDS: 51.76/-116.55/50.95/-115.5                # Bounding box of the domain: lat_max/lon_min/lat_min/lon_max. 

# Domain delineation settings (GRU level)
DOMAIN_DEFINITION_METHOD: lumped                               # Define domain representation method, current options: subset_geofabric, delineate_geofabric, lumped_watershed
ROUTING_DELINEATION: lumped                                    # Spatial discretisation of river network for routing
GEOFABRIC_TYPE: na                                             # Source geofabric to subset from, current options: Merit, TDX, NWS
DELINEATION_METHOD: slope_area                                 # Method for stream identification, options: stream_threshold, curvature, slope_area, multi_scale 
CURVATURE_THRESHOLD: 0.0                                       # Profile curvature threshold for curvature method
MIN_SOURCE_THRESHOLD: 100                                      # Minimum contributing area for stream sources in curvature method
STREAM_THRESHOLD: 5000                                         # Threshold flow accumulation for stream vectorisation
SLOPE_AREA_THRESHOLD: 100.0                                    # Combined slope-area threshold
SLOPE_AREA_EXPONENT: 2.0                                       # Exponent for slope (m in S^m * A^n)
AREA_EXPONENT: 1.0                                             # Exponent for area (n in S^m * A^n)
MULTI_SCALE_THRESHOLDS: 10000,5000,2500,1000,500               # Comma-separated thresholds (coarse to fine)
USE_DROP_ANALYSIS: True                                        # Enable drop analysis to automatically determine optimal threshold
DROP_ANALYSIS_MIN_THRESHOLD: 100                               # Minimum threshold to test
DROP_ANALYSIS_MAX_THRESHOLD: 10000                             # Maximum threshold to test
DROP_ANALYSIS_NUM_THRESHOLDS: 10                               # Number of thresholds to test
DROP_ANALYSIS_LOG_SPACING: True                                # Use logarithmic spacing (recommended)
LUMPED_WATERSHED_METHOD: TauDEM                                # TauDEM for lumped delineation
CLEANUP_INTERMEDIATE_FILES: False                              # Remove temporary files from delieation
DELINEATE_COASTAL_WATERSHEDS: False                            # Delineate coastal hillslopes
DELINEATE_BY_POURPOINT: True                                   # Delineate watershed from pour point
MOVE_OUTLETS_MAX_DISTANCE: 200                                 # Maximum distance to move outlets to stream
MIN_GRU_SIZE: 0                                                # Minimum HRU size, in km^2. Smaller GRUs will be merged 

# Domain discretization settings (HRU level)
DOMAIN_DISCRETIZATION: GRUs                                    # Method to discretize modelling domain, options: elevation, soilclass, landclass, radiation, GRUs
ELEVATION_BAND_SIZE: 200                                       # Elevation band size in meters
MIN_HRU_SIZE: 4                                                # Minimum HRU size in km^2. Smaller HRUs will be merged
RADIATION_CLASS_NUMBER: 5                                      # Number of radiation classes for discretisation
ASPECT_CLASS_NUMBER: 8                                         # Number of aspect classes for discretisation (4, 8, or custom number)
ASPECT_PATH: default                                           # Path to aspect classification raster. If 'default', uses root_path/domain_[name]/attributes/aspect

### ============================================= 3. Model Agnostic settings: =============================================================

FORCING_DATASET: ERA5                                          # Forcing dataset to use
FORCING_VARIABLES: default                                     # Forcing dataset variables to use or acquire                                                                    
FORCING_MEASUREMENT_HEIGHT: 2                                  # Reference height for forcing measurements [m].
FORCING_TIME_STEP_SIZE: 3600                                   # Size of the forcing time step in [s]. Must be constant.
APPLY_LAPSE_RATE: True                                         # Flag for applying lapse rate options: True or False
LAPSE_RATE: 0.0065                                             # [K m-1]
FORCING_SHAPE_LAT_NAME: lat                                    # Name of the latitude field that contains the latitude of forcing.
FORCING_SHAPE_LON_NAME: lon                                    # Name of the longitude field that contains the latitude of forcing.
PET_METHOD: 'oudin'                                            # Method for PET estimation, options: 'oudin', 'hamon', 'hargreaves'

# EM-Earth forcing supplementation settings
SUPPLEMENT_FORCING: False                                      # Supplement forcing data with precip and temperature from EM-EARTH
EM_EARTH_PRCP_DIR: /path/to/EM-EARTH/prcp/data                 # Path to EM-Earth precipitation data
EM_EARTH_TMEAN_DIR: /path/to/EM-EARTH/tmean/data               # Path to EM-Earth temperature data
EM_EARTH_MIN_BBOX_SIZE: 0.1                                    # Minimum bounding box size in degrees for EM-Earth extraction (~10km)
EM_EARTH_MAX_EXPANSION: 0.2                                    # Maximum expansion for small watersheds in degrees (~20km)
EM_PRCP: prcp                                                  # EM-EARTH precip variable to use

### ============================================= 4. Model Specific settings: =============================================================

HYDROLOGICAL_MODEL: SUMMA                                      # Hydrological model, options: SUMMA, FUSE, GR, FLASH 
ROUTING_MODEL: mizuRoute                                       # Routing model, options: mizuRoute

### 4.1 Model Specific settings: SUMMA 
SUMMA_EXE: summa_sundials.exe                                  # Name of SUMMA executable
SETTINGS_SUMMA_CONNECT_HRUS: yes                               # Attribute setting: "no" or "yes". If no; all HRUs modeled as independent columns 
SETTINGS_SUMMA_TRIALPARAM_N: 0                                 # Number of trial parameter specifications in inital setup. Specify 0 if none are wanted (they can still be included in this file but won't be read).
SETTINGS_SUMMA_TRIALPARAM_1:                                   # Name of trial parameter and value to assign. Value assumed to be float.

# Parallel SUMMA settings
SETTINGS_SUMMA_USE_PARALLEL_SUMMA: false                       # Run SUMMA in parallel
SETTINGS_SUMMA_CPUS_PER_TASK: 32                               # Number of cpus to use per task in parallel SUMMA run
SETTINGS_SUMMA_TIME_LIMIT: 01:00:00                            # Time limit for parallel SUMMA run
SETTINGS_SUMMA_MEM: 5                                          # Requested memory for parallel SUMMA run
SETTINGS_SUMMA_GRU_COUNT: 85                                   # Number of GRUs in SUMMA shapefile
SETTINGS_SUMMA_GRU_PER_JOB: 5                                  # Number of GRUs per job
SETTINGS_SUMMA_PARALLEL_PATH: default                          # Path to parallel SUMMA binary, if default self.data_dir / installs / summa / bin
SETTINGS_SUMMA_PARALLEL_EXE: summa_actors.exe                  # Name of parallel SUMMA binary

# SUMMA optimisation settings 
PARAMS_TO_CALIBRATE: tempCritRain,k_soil,vGn_n,theta_sat       # Local parameters to calibrate
BASIN_PARAMS_TO_CALIBRATE: routingGammaScale                   # Basin parameters to calibrate                       
SUMMA_DECISION_OPTIONS:                                        # SUMMA model decisions to analyse in decision analysis, if more than 1 options are selected per category, all permuations will be evaluated
  snowIncept: [lightSnow]                                      # Snow interception, Options: lightSnow (f(new snow density)), stickySnow (f(temperature))
  compaction: [anderson]                                       # Snow compaction, Options: consettl (constant settlement rate), anderson (semi-empirical Anderson 1976)
  snowLayers: [CLM_2010]                                       # Snow layer combination/subdivision, Options: CLM_2010 (CLM rules by layer index), jrdn1991 (SNTHERM uniform rules)
  alb_method: [conDecay]                                       # Albedo evolution, Options: conDecay (constant decay rate), varDecay (variable decay with metamorphism)
  thCondSnow: [smnv2000, jrdn1991]                             # Thermal conductivity of snow, Options: tyen1965 (Yen 1965), melr1977 (Mellor 1977), jrdn1991 (Jordan 1991), smnv2000 (Smirnova et al. 2000)
  vegeParTbl: [MODIFIED_IGBP_MODIS_NOAH]                       # Vegetation parameter table, Options: USGS (24/27 categories), MODIFIED_IGBP_MODIS_NOAH (20 MODIS categories)
  soilStress: [NoahType]                                       # Soil moisture control on stomatal resistance, Options: NoahType (f(volumetric water)), CLM_Type (f(matric head)), SiB_Type (exp log matric head)
  stomResist: [BallBerry]                                      # Stomatal resistance formulation, Options: BallBerry (Ball-Berry model), Jarvis (Jarvis model)
  LAI_method: [monTable]                                       # LAI determination method, Options: monTable (monthly lookup table), specified (from green veg fraction)
  veg_traits: [Raupach_BLM1994]                                # Vegetation roughness length/displacement height, Options: Raupach_BLM1994 (Raupach 1994), CM_QJRMS1998 (Choudhury-Monteith 1998), vegTypeTable (table by veg type)
  canopyEmis: [difTrans]                                       # Canopy emissivity, Options: simplExp (simple exponential), difTrans (f(diffuse transmissivity))
  windPrfile: [logBelowCanopy]                                 # Wind profile through canopy, Options: exponential (exp to surface), logBelowCanopy (log profile below canopy)
  canopySrad: [BeersLaw]                                       # Canopy shortwave radiation, Options: noah_mp (Noah-MP with albedo), CLM_2stream (CLM 2-stream), UEB_2stream (UEB Mahat-Tarboton), NL_scatter (Nijssen-Lettenmaier), BeersLaw (Beer's Law VIC-style)
  soilCatTbl: [ROSETTA]                                        # Soil category dataset, Options: STAS (STATSGO), STAS-RUC (STATSGO-RUC blend), ROSETTA (Rosetta pedotransfer)
  f_Richards: [mixdform]                                       # Form of Richards' equation, Options: moisture (moisture-based), mixdform (mixed formulation)
  groundwatr: [bigBuckt]                                       # Groundwater parameterization, Options: qTopmodl (TOPMODEL exponential), bigBuckt (lumped aquifer), noXplict (no groundwater)
  hc_profile: [constant]                                       # Hydraulic conductivity profile, Options: constant (uniform with depth), pow_prof (power-law decay)
  bcLowrSoiH: [drainage]                                       # Lower boundary condition for soil hydrology, Options: drainage (free drainage), presHead (prescribed head), bottmPsi (f(bottom matric head)), zeroFlux (no flow)
  thCondSoil: [funcSoilWet]                                    # Thermal conductivity of soil, Options: funcSoilWet (f(soil moisture)), mixConstit (weighted constituents), hanssonVZJ (Hansson et al. 2004)
  spatial_gw: [localColumn]                                    # Spatial representation of groundwater, Options: localColumn (column independent), singleBasin (single basin store)
  subRouting: [timeDlay]                                       # Sub-grid routing method, Options: timeDlay (time-delay histogram), qInstant (instantaneous)
  num_method: [itertive]                                       # Numerical solution method, Options: itertive (iterative Newton-Raphson), non_iter (non-iterative), itersurf (iterate surface only)
  fDerivMeth: [analytic]                                       # Flux derivative method, Options: numericl (numerical finite diff), analytic (analytical derivatives)
  bcUpprTdyn: [nrg_flux]                                       # Upper boundary for thermodynamics, Options: presTemp (prescribed temperature), nrg_flux (energy flux)
  bcLowrTdyn: [zeroFlux]                                       # Lower boundary for thermodynamics, Options: presTemp (prescribed temperature), zeroFlux (zero heat flux)
  bcUpprSoiH: [liq_flux]                                       # Upper boundary for soil hydrology, Options: presHead (prescribed head/moisture), liq_flux (liquid water flux)
  astability: [louisinv]                                       # Atmospheric stability function, Options: standard (Monin-Obukhov), louisinv (Louis 1979 inverse), mahrtexp (Mahrt 1987 exponential)

# Soil depth calibration settings
CALIBRATE_DEPTH: False                                         # Enable soil depth profile calibration (True/False)
DEPTH_TOTAL_MULT_BOUNDS: [0.1, 5.0]                            # Bounds for total depth multiplier [min, max]
DEPTH_SHAPE_FACTOR_BOUNDS: [0.1, 3.0]                          # Bounds for shape factor [min, max]

###  4.2 Model Specific settings: FUSE 
FUSE_INSTALL_PATH: default                                     # FUSE installation path, if default, self.code_dir / installs / fuse / bin
FUSE_EXE: fuse.exe                                             # Name of FUSE executable
FUSE_ROUTING_INTEGRATION: mizuRoute                            # Routing method for distributed FUSE
SETTINGS_FUSE_PATH: default                                    # Path to FUSE run settings, if default self.data_dir / settings / FUSE
SETTINGS_FUSE_FILEMANAGER: fm_catch.txt                        # Name of FUSE file manager
FUSE_SPATIAL_MODE: distributed                                 # Spatial discretisation of FUSE, options: lumped or semi-distributed
EXPERIMENT_OUTPUT_FUSE: default                                # Directory for FUSE experiment output

# FUSE optimisation settings
SETTINGS_FUSE_PARAMS_TO_CALIBRATE: MAXWATR_1,MAXWATR_2,BASERTE,QB_POWR,TIMEDELAY,PERCRTE,FRACTEN,RTFRAC1,MBASE,MFMAX,MFMIN,PXTEMP,LAPSE
FUSE_DECISION_OPTIONS:                                         # Model decisions to analyse in decision analysis, if more than 1 options are selected per category, all permuations will be evaluated
    RFERR: [additive_e, multiplc_e]                            # Rainfall error model, Options: additive_e (additive error), multiplc_e (multiplicative error)
    ARCH1: [tension1_1]                                        # Upper soil layer architecture, Options: tension1_1 (single tension storage), tension2_1 (two tension stores), onestate_1 (single state no tension)
    ARCH2: [tens2pll_2]                                        # Lower soil layer architecture, Options: tens2pll_2 (tension storage two parallel tanks), unlimfrc_2 (unlimited fraction rate), unlimpow_2 (unlimited power recession), fixedsiz_2 (fixed size tanks)
    QSURF: [arno_x_vic, prms_varnt]                            # Surface runoff generation, Options: arno_x_vic (ARNO/VIC parameterization), prms_varnt (PRMS variant), tmdl_param (TOPMODEL parameterization)
    QPERC: [perc_f2sat]                                        # Percolation between soil layers, Options: perc_f2sat (field capacity to saturation), perc_w2sat (wilting point to saturation), perc_lower (percolation to lower layer)
    ESOIL: [sequential]                                        # Evaporation from soil, Options: sequential (sequential evaporation), rootweight (root-weighted evaporation)
    QINTF: [intflwnone]                                        # Interflow from soil layers, Options: intflwnone (no interflow), intflwsome (interflow present)
    Q_TDH: [rout_gamma]                                        # Routing scheme, Options: rout_gamma (gamma distribution routing), no_routing (no routing)
    SNOWM: [temp_index, no_snowmod]                            # Snow module, Options: temp_index (temperature index method), no_snowmod (no snow module)

###  4.3 Model Specific settings: GR 
SETTINGS_GR_PATH: default                                      # Path to GR run settings, if default self.project_dir / settings / GR
SETTINGS_GR_CONTROL: default                                   # Path to GR control file
GR_INSTALL_PATH: default                                       # Path to GR installation, if default uses self.data_dir / installs / GR
GR_EXE: GR.r                                                   # Name of GR executable script
GR_spatial: lumped                                             # Spatial discretisation of GR, options: lumped or semi-distributed
GR_SPATIAL_MODE: distributed                                  # Options: 'lumped', 'distributed'
GR_ROUTING_INTEGRATION: mizuRoute                             # Options: 'none', 'mizuRoute'

###  4.4 Model Specific settings: LSTM 
FLASH_LOAD: False                                              # Load existing flash model from storage. If false creates and trains new model.
FLASH_HIDDEN_SIZE: 128                                         # Number of hidden layer
FLASH_NUM_LAYERS: 3                                            # Number of active layers
FLASH_EPOCHS: 300                                              # Number of training epochs
FLASH_BATCH_SIZE: 64                                           # Training batch size
FLASH_LEARNING_RATE: 0.001                                     # LSTM learning rate
FLASH_LEARNING_PATIENCE: 30                                    # LSTM learning patience
FLASH_LOOKBACK: 700                                            # Lookback timesteps
FLASH_DROPOUT: 0.2                                             # LSTM Dropout ratio
FLASH_L2_REGULARIZATION: 1e-6                                  # L2 regularization
FLASH_USE_ATTENTION: True                                      # Use attention
FLASH_USE_SNOW: False                                          # Use snow data

###  4.5 Model Specific settings: MizuRoute 
SETTINGS_MIZU_WITHIN_BASIN: 0                                  # '0' (no) or '1' (IRF routing). Flag to enable within-basin routing by mizuRoute. Should be set to 0 if SUMMA is run with "subRouting" decision "timeDlay".
SETTINGS_MIZU_ROUTING_DT: 86400                                # Duration of the routing time step [s].
SETTINGS_MIZU_ROUTING_UNITS: mm/d                              # Units of the variable to be routed.
SETTINGS_MIZU_ROUTING_VAR: q_routed                            # Name of output variable to use for routing.
SETTINGS_MIZU_OUTPUT_FREQ: single                              # Frequency with which mizuRoute generates new output files. Must be one of 'single', 'daily', 'monthly', 'yearly'.
SETTINGS_MIZU_OUTPUT_VARS: 1                                   # Routing output. '0' for both KWT and IRF; '1' IRF only; '2' KWT only.
SETTINGS_MIZU_MAKE_OUTLET: n/a                                 # Segment ID or IDs that should be set as network outlet. Specify multiple IDs separated by commas: X,Y,Z. Specify no IDs as: n/a. Note that this can also be done in the network shapefile.
SETTINGS_MIZU_NEEDS_REMAP: no                                  # 'no' if routing basins map 1:1 onto model GRUs. 'yes' if river segments span multiple GRUs or if multiple segments are inside a single GRU.

###  4.5 Model Specific settings: NextGen 
NGEN_INSTALL_PATH: '/path/to/ngen/build'
NGEN_EXE: ngen
NGEN_BMI_MODULES:
   CFE:
     bmi_type: 'bmi_c'
     library_file: './extern/cfe/cmake_build/libcfebmi.so'
     init_config: './ngen_data/bmi_configs/cfe_config.json'
     main_output_variable: 'Q_OUT'

NGEN_MODULES_TO_CALIBRATE: CFE,NOAH,PET                        # Options: CFE, NOAH, PET (or combinations like "CFE,PET")
NGEN_CFE_PARAMS_TO_CALIBRATE: smcmax,satdk,bb,slop
NGEN_NOAH_PARAMS_TO_CALIBRATE: rain_snow_thresh,ZREF,noah_refdk,noah_refkdt,noah_czil,noah_z0,noah_frzk,noah_salp
NGEN_PET_PARAMS_TO_CALIBRATE: pet_albedo,pet_z0_mom,pet_z0_heat,pet_veg_h,pet_d0
NGEN_ACTIVE_CATCHMENT_ID: cat-1

# Mizuroute Paths and filenames
SETTINGS_MIZU_PATH: default                                    # Directory containing mizuroute settings. If "default" self.data_dir / settings / mizuRoute
INSTALL_PATH_MIZUROUTE: default                                # Mizuroute installation path. If "default", self.code_dir / installs / mizuRoute / route / bin
EXE_NAME_MIZUROUTE: mizuRoute.exe                              # Name of mizuroute executable
SETTINGS_MIZU_TOPOLOGY: topology.nc                            # Name of the river network topology file.
SETTINGS_MIZU_PARAMETERS: param.nml.default                    # Mizuroute parameter file
SETTINGS_MIZU_CONTROL_FILE: mizuroute.control                  # Name of the control file.
SETTINGS_MIZU_REMAP: routing_remap.nc                          # Name of the optional catchment remapping file, for cases when SUMMA uses different catchments than mizuRoute.
                           
### ============================================= 5. Evaluation settings: =================================================================

# Analysis types to run
EVALUATION_DATA: [streamflow]                                  # Evaluation data to acquire. Options: streamflow, snow, ground_water, fluxnet
ANALYSES: [benchmarking, attributes]                           # Options: sensitivity, decision, benchmarking, attributes
SIM_REACH_ID: 123                                              # River reach ID used for streamflow evaluation and optimization

# Streamflow data settings
STREAMFLOW_DATA_PROVIDER: WSC                                  # Provider of streamflow data, current options: USGS, WSC, VI, NIWA
DOWNLOAD_USGS_DATA: False                                      # Download USGS data through API
DOWNLOAD_WSC_DATA: True                                        # Download HYDAT data from HPC
STATION_ID: 05BB001                                            # Station ID from provider

# SNOTEL data settings
DOWNLOAD_SNOTEL: false                                         # Download SNOTEL data, options: 'true' or 'false'
SNOTEL_STATION:                                                # SNOTEL station ID (numeric)
SNOTEL_PATH: '/path/to/data/geospatial-data/SNOTEL'            # Path to directory containing SNOTEL data files

# FLUXNET data settings
DOWNLOAD_FLUXNET: false                                        # Download FLUXNET data, options: 'true' or 'false'
FLUXNET_STATION:                                               # FLUXNET station ID (numeric)
FLUXNET_PATH: '/path/to/data/data/geospatial-data/fluxnet'     # Path to directory containing FLUXNET data files

# USGS GW data settings
DOWNLOAD_USGS_GW: false                                        # Download USGS groundwater data, options: 'true' or 'false'
USGS_STATION:  06306300                                        # USGS   station ID (numeric)

# Remote sensing data settings 
DOWNLOAD_SMAP: false                                           # Download SMAP soil moisture data
SMAP_PRODUCT: SPL4SMGP                                         # SMAP product version
SMAP_PATH: default                                             # Path to SMAP data directory

DOWNLOAD_GRACE: false                                          # Download GRACE groundwater storage data
GRACE_PRODUCT: RL06                                            # GRACE product release
GRACE_PATH: default                                            # Path to GRACE data directory

DOWNLOAD_MODIS_SNOW: false                                     # Download MODIS snow cover data (beyond landcover)
MODIS_SNOW_PRODUCT: MOD10A1.006                                # MODIS snow product
MODIS_SNOW_PATH: default                                       # Path to MODIS snow data

# Attribute Processing settings
ATTRIBUTES_DATA_DIR: default                                   # Base directory for attribute data, if default uses data_dir/geospatial-data
ATTRIBUTES_SOILGRIDS_PATH: default                             # Will use {data_dir}/geospatial-data/soilgrids
ATTRIBUTES_PELLETIER_PATH: default                             # Will use {data_dir}/geospatial-data/pelletier
ATTRIBUTES_MERIT_PATH: default                                 # Will use {data_dir}/geospatial-data/merit
ATTRIBUTES_MODIS_PATH: default                                 # Will use {data_dir}/geospatial-data/modis
ATTRIBUTES_GLCLU_PATH: default                                 # Will use {data_dir}/geospatial-data/glclu2019
ATTRIBUTES_FOREST_HEIGHT_PATH: default                         # Will use {data_dir}/geospatial-data/forest_height
ATTRIBUTES_WORLDCLIM_PATH: default                             # Will use {data_dir}/geospatial-data/worldclim
ATTRIBUTES_GLIM_PATH: default                                  # Path to GLiM geological data, if default uses ATTRIBUTES_DATA_DIR/glim
ATTRIBUTES_GROUNDWATER_PATH: default                           # Path to groundwater data, if default uses ATTRIBUTES_DATA_DIR/groundwater
ATTRIBUTES_STREAMFLOW_PATH: default                            # Path to streamflow data/metrics, if default uses project_dir/observations/streamflow
HRU_GAUGE_MAPPING: {}                                          # Mapping between HRU IDs and gauge IDs for distributed domains
ATTRIBUTES_GLWD_PATH: default                                  # Path to Global Lakes and Wetlands Database, if default uses ATTRIBUTES_DATA_DIR/glwd
ATTRIBUTES_HYDROLAKES_PATH: default                            # Path to HydroLAKES data, if default uses ATTRIBUTES_DATA_DIR/hydrolakes
ATTRIBUTES_OUTPUT_DIR: default                                 # Output directory for processed attributes, if default uses project_dir/attributes

### ============================================= 6. Optimisation settings: ===============================================================

OPTIMISATION_METHODS: [iteration]                              # Methods to optimise the model performance, options: 'emulation', 'iteration'
CALIBRATION_TIMESTEP: hourly                                   # Timestep to use for calibration, options: 'native', 'hourly', 'daily'

# Iterative optimisation settings
ITERATIVE_OPTIMIZATION_ALGORITHM: DE                           # Options DDS, DE, PSO, NSGA-II, ADAM or SCE-UA
NUMBER_OF_ITERATIONS: 5000                                      # Number of iterations for calibration 
POPULATION_SIZE: 30                                            # Population size for genetic algorithms
OPTIMIZATION_METRIC: KGE                                       # Options: Root mean square error : "RMSE", Nash-Suthcliffe efficiency: "NSE", Kling-Gupta Efficiency: "KGE", KGE projected: "KGEp", Mean absolute error: "MAE"
TARGET_METRIC: KGE                                             # Ensure consistency

  # -- DE specific settings
DE_SCALING_FACTOR: 0.5                                         # F parameter (mutation strength)
DE_CROSSOVER_RATE: 0.9                                         # CR parameter (crossover probability)  
POPULATION_SIZE: 30                                            # Optional - will auto-size to 4*num_params if not set

  # -- DDS specific settings
DDS_R:  0.4                                                    # DDS perturbation parameter
ASYNC_DDS_POOL_SIZE: 10                                        # Size of shared solution pool
ASYNC_DDS_BATCH_SIZE: 10                                       # Evaluations per batch  
MAX_STAGNATION_BATCHES: 10                                     # Stop after N batches without improvement

  # -- SCE-UA specific settings
NUMBER_OF_COMPLEXES: 2                                         # Number of complexes in SCE-UA
POINTS_PER_SUBCOMPLEX: 5                                       # Number of points per subcomplex in SCE-UA
NUMBER_OF_EVOLUTION_STEPS: 20                                  # Number of evolution steps per complex in SCE-UA
EVOLUTION_STAGNATION: 5                                        # Number of iterations with minimal improvement before convergence
PERCENT_CHANGE_THRESHOLD: 0.01                                 # Threshold for percent change in objective function
  
  # -- PSO specific settings 
SWRMSIZE: 20                                                   # Number of particles in the swarm
PSO_COGNITIVE_PARAM: 1.5                                       # Personal best influence
PSO_SOCIAL_PARAM: 1.5                                          # Global best influence 
PSO_INERTIA_WEIGHT: 0.7                                        # Inertia weight
PSO_INERTIA_REDUCTION_RATE: 0.99                               # Rate at which inertia reduces
INERTIA_SCHEDULE: LINEAR                                       # MULTIPLICATIVE or LINEAR

  # -- NSGA-II specific settings
NSGA2_CROSSOVER_RATE: 0.9                                      # Crossover probability
NSGA2_MUTATION_RATE: 0.1                                       # Mutation probability  
NSGA2_ETA_C: 20                                                # Crossover distribution index
NSGA2_ETA_M: 20                                                # Mutation distribution index

# Emulator optimisation settings
DPE_TRAINING_CACHE: default                                    # Path to training cache
DPE_HIDDEN_DIMS: [256, 128, 64]                                # Size of hidden dimensions 
DPE_TRAINING_SAMPLES: 500                                      # Number of training samples used for emulator training
DPE_VALIDATION_SAMPLES: 100                                    # Number of samples used for emulator evaluation 
DPE_EPOCHS: 300                                                # Epochs used for training
DPE_LEARNING_RATE: 1e-3                                        # NN learning rate
DPE_OPTIMIZATION_LR: 1e-2                                      # Optimisation learning rate
DPE_OPTIMIZATION_STEPS: 200                                    # Number of steps in optimisation 
DPE_OPTIMIZER: "ADAM"                                          # ADAM or L-BFGS
DPE_OBJECTIVE_WEIGHTS:                                         # Objective function weights 
  KGE: 1.0

# Iterative Emulator Configuration (NEW)
DPE_EMULATOR_ITERATE: true                                     # Enable iterative emulator refinement
DPE_ITERATE_MAX_ITERATIONS: 5                                  # Maximum number of iterative cycles
DPE_ITERATE_SAMPLES_PER_CYCLE: 100                             # New samples to generate per iteration
DPE_ITERATE_SAMPLING_RADIUS: 0.1                               # Radius around optimum for sampling (0-1 normalized space)
DPE_ITERATE_CONVERGENCE_TOL: 1e-4                              # Convergence tolerance for parameter changes
DPE_ITERATE_MIN_IMPROVEMENT: 1e-6                              # Minimum objective improvement to continue
DPE_ITERATE_SAMPLING_METHOD: "gaussian"                        # "gaussian" | "uniform" | "adaptive"

# Autodiff/FD controls
DPE_USE_NN_HEAD: true                                          # Use a neural network for autodiff optimisation 
DPE_PRETRAIN_NN_HEAD: false                                    # Pretrain NN head with emulator data
DPE_USE_SUNDIALS: true                                         # Ignored if EMULATOR_SETTING == SUMMA_AUTODIFF_FD
DPE_AUTODIFF_STEPS: 100                                        # Steps in differential optimisation 
DPE_AUTODIFF_LR: 0.001                                         # Learning rate for autodiff
DPE_FD_STEP: 0.005                                             # FD step size
DPE_GD_STEP_SIZE: 0.1                                          # GD step size

# Large Domain Emulation settings
LARGE_DOMAIN_EMULATION_ENABLED: True                           # Enable large domain emulation
EMULATOR_SETTING: SUMMA_AUTODIFF_FD                            # Options: "EMULATOR" : train NN emulator;  backprop through NN only- "FD" : optimize parameters using finite-difference gradients on SUMMA- "SUMMA_AUTODIFF" : end-to-end autograd using SUMMA sensitivities (Sundials) when available, - "SUMMA_AUTODIFF_FD" : same autograd wrapper but forcing FD Jacobian (no Sundials)
LARGE_DOMAIN_EMULATOR_MODE: "SUMMA_AUTODIFF"                   # Options: FD, SUMMA_AUTODIFF, SUMMA_AUTODIFF_FD
LARGE_DOMAIN_EMULATOR_OPTIMIZER: "Adam"                        # Options: Adam or L-BFGS
LARGE_DOMAIN_TRAINING_EPOCHS: 100                              # Number of training epochs
LARGE_DOMAIN_PARAMETER_ENSEMBLE_SIZE: 1000                     # Parameter ensemble size
LARGE_DOMAIN_BATCH_SIZE: 32                                    # Batch size for processing
LARGE_DOMAIN_VALIDATION_SPLIT:                                 # Split in eval and calibration data
LARGE_DOMAIN_EMULATOR_PRETRAIN_NN_HEAD: true                   # Enable pretraining
LARGE_DOMAIN_EMULATOR_USE_NN_HEAD: true                        # Must be true for pretraining
LARGE_DOMAIN_EMULATOR_TRAINING_SAMPLES: 200                    # Samples for pretraining
LARGE_DOMAIN_EMULATOR_EPOCHS: 30                               # Graph transformer training epochs 
LARGE_DOMAIN_EMULATOR_AUTODIFF_STEPS: 100                      # Autodiff optimization steps

# Multiobjective weights
LARGE_DOMAIN_EMULATOR_STREAMFLOW_WEIGHT: 0.5                   # Streamflow relevance
LARGE_DOMAIN_EMULATOR_SMAP_WEIGHT: 0.2                         # Soil moisture relevance
LARGE_DOMAIN_EMULATOR_GRACE_WEIGHT: 0.15                       # Storage relevance
LARGE_DOMAIN_EMULATOR_MODIS_WEIGHT: 0.15                       # Snow relevance

# Training configuration
LARGE_DOMAIN_EMULATOR_TRAINING_SAMPLES: 500                    # LDE training samples
LARGE_DOMAIN_EMULATOR_EPOCHS: 50                               # LDE training epochs

# Single Sample Emulation settings
EMULATION_NUM_SAMPLES: 100                                     # Number of parameter sets to generate (default: 100)
EMULATION_SEED: 22                                             # Random seed for emulation to ensure reproducibility 
EMULATION_SAMPLING_METHOD: lhs                                 # Sampling method (uniform, lhs, sobol)
EMULATION_PARALLEL_ENSEMBLE: false                             # Run ensemble simulations in parallel (requires MPI)
EMULATION_MAX_PARALLEL_JOBS: 100                               # Maximum number of parallel jobs when running ensemble
EMULATION_SKIP_MIZUROUTE: false                                # Skip running mizuRoute (for troubleshooting)
EMULATION_USE_ATTRIBUTES: false                                # Use attributes to train parameter emulator
EMULATION_MAX_ITERATIONS: 3                                   # Iterative refinement

### ============================================= 7. Data and Path Settings: =====================================================================

# Shapefile settings - Catchment shape (with HRU sub-basins)
CATCHMENT_SHP_LAT: center_lat                                  # Name of the latitude column. Should be a value representative for the HRU. Typically the centroid
CATCHMENT_SHP_LON: center_lon                                  # Name of the longitude column. Should be a value representative for the HRU. Typically the centroid.
CATCHMENT_SHP_AREA: HRU_area                                   # Name of the catchment area column. Area must be in units [m^2]
CATCHMENT_SHP_HRUID: HRU_ID                                    # HRU ID column in riverBasin shapefile
CATCHMENT_SHP_GRUID: GRU_ID                                    # GRU ID column in riverBasin shapefile
CATCHMENT_PATH: default                                        # Path to domain catchment shapefile. If default, uses self.data_dir / shapefiles / catchment / 
CATCHMENT_SHP_NAME: default                                    # Name of domain catchment shapefile used in data acquisition and modelling 

# Shapefile settings - Basins shape (GRUs from watershed delineation)
RIVER_BASIN_SHP_RM_GRUID: GRU_ID                               # GRU ID column in riverBasin shapefile
RIVER_BASIN_SHP_HRU_TO_SEG: gru_to_seg                         # Name of the column that shows which river segment each HRU connects to.
RIVER_BASIN_SHP_AREA: GRU_area                                 # Name of the catchment area column. Area must be in units [m^2]
RIVER_BASINS_PATH: default                                     # Path to delineated river basins shapefile. If default, uses self.data_dir / shapefiles / river_basins
RIVER_BASINS_NAME: default                                     # Name of river basin shapefile

# Shapefile settings - River network shape 
RIVER_NETWORK_SHP_LENGTH: Length                               # Name of the segment length column. Length must be in units [m].
RIVER_NETWORK_SHP_SEGID: LINKNO                                # Name of the segment ID column.
RIVER_NETWORK_SHP_DOWNSEGID: DSLINKNO                          # Name of the downstream segment ID column.
RIVER_NETWORK_SHP_SLOPE: Slope                                 # Name of the slope column. Slope must be in in units [length/length].
RIVER_NETWORK_SHP_PATH: default                                # Path to river network shapefile. If default, uses self.data_dir / shapefiles / river_network
RIVER_NETWORK_SHP_NAME: default                                # Name of domain river network shapefile 

# Pour point shapefile path
POUR_POINT_SHP_PATH: default                                   # If 'default', uses 'root_path/domain_[name]/shapefiles/pour_point'.
POUR_POINT_SHP_NAME: default                                   # If 'default', uses '[domain_name]_pourPoint.shp'.

# Forcing path settings
FORCING_PATH: default                                          # If default, uses, self.project_dir / forcing / raw_data

# Observation data path settings
OBSERVATIONS_PATH: default                                     # Path to observed streamflow data for evaluation. If default, uses self.data_dir / observations / streamflow / preprocessed / config['DOMAIN_NAME']_streamflow_processed.csv
STREAMFLOW_RAW_PATH: default                                   # Path to streamflow raw data
STREAMFLOW_RAW_NAME: default                                   # Name of streamflow raw data file
STREAMFLOW_PROCESSED_PATH: default                             # Path to streamflow processed dataset. If default, uses self.data_dir / observations / streamflow / preprocessed / config['DOMAIN_NAME']_streamflow_processed.csv
HYDAT_PATH: default                                            # Path to HYDAT database      
SIMULATIONS_PATH: default                                      # Path to streamflow simulation results, if default, uses self.data_dir / simulations / config['EXPERIMENT_ID'] / mizuRoute / 

# Model path settings
# Hype paths
SETTINGS_HYPE_PATH: default                                    # Path to HYPE run settings, if default self.data_dir / settings / HYPE
HYPE_INSTALL_PATH: default                                     # HYPE installation path, if default, self.code_dir / installs / hype / bin

# GR Paths
SETTINGS_GR_PATH: default                                      # Path to GR run settings, if default self.project_dir / settings / GR
SETTINGS_GR_CONTROL: default                                   # Path to GR control file
GR_INSTALL_PATH: default                                       # Path to GR installation, if default uses self.data_dir / installs / GR

# FUSE paths
SETTINGS_FUSE_FILEMANAGER: default                             # Name of FUSE file manager
SETTINGS_FUSE_PATH: default                                    # Path to FUSE run settings, if default self.data_dir / settings / FUSE
FUSE_INSTALL_PATH: default                                     # FUSE installation path, if default, self.code_dir / installs / fuse / bin
EXPERIMENT_OUTPUT_FUSE: default                                # Directory for FUSE experiment output

# SUMMA paths
SETTINGS_SUMMA_PATH: default                                   # Path to SUMMA run settings, if default self.data_dir / settings / SUMMA
EXPERIMENT_OUTPUT_SUMMA: default                               # Path to SUMMA output. If 'default', uses 'root_path/domain_[name]/simulations/[experiment_id]/SUMMA'.
EXPERIMENT_LOG_SUMMA: default                                  # Path to SUMMA experiment log file. If 'default', uses 'root_path/domain_[name]/simulations/[experiment_id]/mizuRoute/mizuRoute_logs'
SETTINGS_SUMMA_PARALLEL_PATH: default                          # Path to parallel SUMMA binary, if default self.data_dir / installs / summa / bin
SUMMA_INSTALL_PATH: default                                    # SUMMA installation path, if default, self.code_dir / installs / summa / bin
SETTINGS_SUMMA_FILEMANAGER: fileManager.txt                    # Name of SUMMA file manager
SETTINGS_SUMMA_FORCING_LIST: forcingFileList.txt               # Name of SUMMA forcing file list
SETTINGS_SUMMA_COLDSTATE: coldState.nc                         # Name of SUMMA initial conditions file
SETTINGS_SUMMA_TRIALPARAMS: trialParams.nc                     # Name of SUMMA trial parameters file
SETTINGS_SUMMA_ATTRIBUTES: attributes.nc                       # Name of SUMMA attributes file
SETTINGS_SUMMA_OUTPUT: outputControl.txt                       # Name of SUMMA output control file
SETTINGS_SUMMA_BASIN_PARAMS_FILE: basinParamInfo.txt           # Name of SUMMA basin parameters file
SETTINGS_SUMMA_LOCAL_PARAMS_FILE: localParamInfo.txt           # Name of SUMMA basin parameters file

# Mizuroute paths and filenames
EXPERIMENT_LOG_MIZUROUTE: default                              # Path to mizuRoute experiment log file. If 'default', uses 'root_path/domain_[name]/simulations/[experiment_id]/SUMMA'/SUMMA_logs.
EXPERIMENT_OUTPUT_MIZUROUTE: default                           # Path to mizuRoute output. If 'default', uses 'root_path/domain_[name]/simulations/[experiment_id]/mizuRoute'.
SETTINGS_MIZU_PATH: default                                    # Directory containing mizuroute settings. If "default" self.data_dir / settings / mizuRoute
INSTALL_PATH_MIZUROUTE: default                                # Mizuroute installation path. If "default", self.code_dir / installs / mizuRoute / route / bin
SETTINGS_MIZU_TOPOLOGY: topology.nc                            # Name of the river network topology file.
SETTINGS_MIZU_PARAMETERS: param.nml.default                    # Mizuroute parameter file
SETTINGS_MIZU_CONTROL_FILE: mizuroute.control                  # Name of the control file.
SETTINGS_MIZU_REMAP: routing_remap.nc                          # Name of the optional catchment remapping file, for cases when SUMMA uses different catchments than mizuRoute.

# Intersection paths (for zonal statistics)
INTERSECT_SOIL_PATH: default                                   # If 'default', uses 'root_path/domain_[name]/shapefiles/catchment_intersection/with_soilgrids'.
INTERSECT_SOIL_NAME: default                                   # Name of the shapefile with intersection between catchment and SOILGRIDS-derived USDA soil classes, stored in columns 'USDA_{1,...n}'
INTERSECT_ROUTING_PATH: default                                # If 'default', uses 'root_path/domain_[name]/shapefiles/catchment_intersection/with_routing'.
INTERSECT_ROUTING_NAME: default                                # Name of the shapefile with intersection between hydrologic model catchments and routing model catchments.
INTERSECT_DEM_PATH: default                                    # If 'default', uses 'root_path/domain_[name]/shapefiles/catchment_intersection/with_routing'.
INTERSECT_DEM_NAME: default                                    # Name of the shapefile with intersection between hydrologic model catchments and routing model catchments.
INTERSECT_LAND_PATH: default                                   # If 'default', uses 'root_path/domain_[name]/shapefiles/catchment_intersection/with_routing'.
INTERSECT_LAND_NAME: default                                   # Name of the shapefile with intersection between hydrologic model catchments and routing model catchments.

# Geospatial data paths
OUTPUT_BASINS_PATH: default                                    # If 'default', uses 'root_path/domain_[name]/shapefiles/river_basins/[domain_name]_riverBasins.shp'
OUTPUT_RIVERS_PATH: default                                    # If 'default', uses 'root_path/domain_[name]/shapefiles/river_network/[domain_name]_riverNetwork.shp'
DEM_PATH: default                                              # If 'default', uses 'root_path/domain_[name]/attributes/elevation/dem/'
DEM_NAME: default                                              # Name of elevation dem tiff
SOURCE_GEOFABRIC_BASINS_PATH: default                          # Path to source geofabric basins
SOURCE_GEOFABRIC_RIVERS_PATH: default                          # Path to source geofabric rivers
TAUDEM_DIR: default                                            # If 'default', uses 'root_path/installs/TauDEM 
OUTPUT_DIR: default                                            # If 'default', uses 'root_path/domain_[name]/shapefiles/r
CATCHMENT_PLOT_DIR: default                                    # Directory to output plots of domain catchment
SOIL_CLASS_PATH: default                                       # Path to soil classification raster. If 'default', uses root_path/domain_[name]/attributes/soilclass
SOIL_CLASS_NAME: default                                       # Name of soil classification raster
LAND_CLASS_PATH: default                                       # Path to land classification raster. If 'default', uses root_path/domain_[name]/attributes/landclass      
LAND_CLASS_NAME: default                                       # Name of land classification raster
RADIATION_PATH: default                                        # Path to radiation classification raster. If 'default', uses root_path/domain_[name]/attributes/radiation 

# MAF Tool paths
DATATOOL_PATH: default                                         # Path to datatool executable 
GISTOOL_PATH: default                                          # Path to gistool executable
EASYMORE_CLIENT: easymore cli                                  # Name of easymore client
DATATOOL_DATASET_ROOT: /path/to/meteorological-data/           # Path to datatool datasets root directory
DATATOOL_CACHE: /path/to/cache/dir                             # Cache directory used in datatool
GISTOOL_DATASET_ROOT: /path/to/geospatial-data/                # Path to gistool datasets root directory
GISTOOL_LIB_PATH: /path/to/r-env/                              # Path to gistool libraries
TOOL_CACHE: /path/to/cache/dir                                 # Path to gistool cache directory
EASYMORE_CACHE: /path/to/cache/dir                             # Path to easymore cache directory
EASYMORE_JOB_CONF: /path/to/esmr/job_config                    # Path to easymore job config
CLUSTER_JSON: /path/to/cluster.json                            # Path to cluster json config




